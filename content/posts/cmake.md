+++
title = "CMake Intro"
date = "2023-11-20"
template = "blog-page.html"
draft = true

extra.author = "Adam D"
+++

### Resources

- [CMake documentation](https://cmake.org/cmake/help/latest/index.html)  
- [CMake Supported Generators](https://cmake.org/cmake/help/latest/manual/cmake-generators.7.html)

### Notes

**Windows [Visual Studio]**  
It can be difficult to set up your development environment on windows. I've never used CMake with Visual Studio, but I know CMake can generate Visual Studio build files. If you're using visual studio, this may or may not work.

**Windows [Generators]**  
You will need a build system for CMake to generate. [Ninja](https://ninja-build.org/) is a common one that is easy to get on most platforms. If you're using mingw, your mingw distribution likely includes a version of make.

**MacOS**  
I don't own one nor have I ever developed on one, so I have no idea if cmake even makes sense as a build system.

## First steps

First lets see how to set up a basic hello world.

```ascii
+-- hello
|   +-- CMakeLists.txt
|   +-- src
|   |   +-- hello.hpp
|   |   +-- hello.cpp
```

```cpp
// hello.hpp
#pragma once

#include <iostream>

namespace hello{
    auto greet() {
        std::cout << "Hello world!\n"; 
    }
}
```

```cpp
// hello.cpp
#include "hello.hpp"

auto main() -> int {
    hello::greet();
    return 0;
}
```

Now we can build up our CMakeLists.txt file.

```cmake
# Start by specifying the minimum cmake version.
# To be safe, just use whatever version you get when you run `cmake --version`.
# This sets the minimum cmake version for anyone trying to build from this cmake file.
cmake_minimum_required(VERSION 3.27.2)

# The project command is used to set a project name, version, included languages, descriptions, and
# other project information. For now, only a name is necessary.
project(hello_proj)

# Next, create an executable target with the `add_executable` command.
add_executable(hello)

# Add your source files to your target, to be compiled.
target_sources(hello PRIVATE
    src/hello.cpp
)
```

Generate your build configuration by running `cmake -S . -B build` from the top level `hello` directory. If you get an error, you may need to specify a generator. Remove the `build` directory generated by cmake before trying again. [Here](https://cmake.org/cmake/help/latest/manual/cmake-generators.7.html) is a list of CMake supported generators. In which case the command will look like one of these:  

```sh
cmake -S . -B build -G Ninja
cmake -S . -B build -G "MinGW MakeFiles"
```

With your build configuration generated, run `cmake --build build`. There should be a file in the build directory `build/hello(.exe)`. Execute the file, and you should see `Hello world!` return in the terminal.

```sh
> build/hello  
# Hello world!
```
